<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NRR Calculator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f8f9fa;
    }

    .info-icon {
      cursor: pointer;
      margin-left: 5px;
      color: #0d6efd;
    }

    .form-label {
      font-weight: 500;
    }

    .result-card {
      margin-top: 25px;
    }

    .tooltip-inner {
      max-width: 300px;
      text-align: left;
    }
  </style>
</head>

<body>
  <div class="container py-4">
    <div class="card shadow">
      <div class="card-header text-center">
        <h4>ðŸ§® NRR Qualification Calculator</h4>
      </div>
      <div class="card-body">
        <form id="nrrForm">
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Your Team Name <i class="bi bi-info-circle-fill info-icon" data-bs-toggle="tooltip" title="The team you're supporting or analyzing."></i></label>
              <input type="text" class="form-control" id="supporting_team" required />
            </div>
            <div class="col-md-6">
              <label class="form-label">Opposing Team Name <i class="bi bi-info-circle-fill info-icon" data-bs-toggle="tooltip" title="The team playing against your team."></i></label>
              <input type="text" class="form-control" id="against_team" required />
            </div>
            <div class="col-md-6">
              <label class="form-label">Runs Scored <i class="bi bi-info-circle-fill info-icon" data-bs-toggle="tooltip" title="Total runs scored by your team so far in the tournament."></i></label>
              <input type="number" class="form-control" id="runs_scored" required />
            </div>
            <div class="col-md-6">
              <label class="form-label">Overs Played (e.g., 19.4) <i class="bi bi-info-circle-fill info-icon" data-bs-toggle="tooltip" title="Overs your team has faced while batting. Enter in X.Y format, where Y â‰¤ 5."></i></label>
              <input type="text" class="form-control" id="overs_played" required />
            </div>
            <div class="col-md-6">
              <label class="form-label">Runs Conceded <i class="bi bi-info-circle-fill info-icon" data-bs-toggle="tooltip" title="Total runs scored against your team."></i></label>
              <input type="number" class="form-control" id="runs_scored_against" required />
            </div>
            <div class="col-md-6">
              <label class="form-label">Overs Bowled (e.g., 20.0) <i class="bi bi-info-circle-fill info-icon" data-bs-toggle="tooltip" title="Total overs your team has bowled. Use X.Y format, where Y â‰¤ 5."></i></label>
              <input type="text" class="form-control" id="overs_played_against" required />
            </div>
            <div class="col-md-6">
              <label class="form-label">Final Match Overs <i class="bi bi-info-circle-fill info-icon" data-bs-toggle="tooltip" title="Overs expected to be played in the final match. Usually 20 in T20."></i></label>
              <input type="text" class="form-control" id="overs" required />
            </div>
            <div class="col-md-6">
              <label class="form-label">Expected Runs in Final <i class="bi bi-info-circle-fill info-icon" data-bs-toggle="tooltip" title="Runs expected to be scored in the final match by one team."></i></label>
              <input type="number" class="form-control" id="final_runs" required />
            </div>
            <div class="col-md-6">
              <label class="form-label">Required NRR <i class="bi bi-info-circle-fill info-icon" data-bs-toggle="tooltip" title="The Net Run Rate your team must reach to qualify."></i></label>
              <input type="number" class="form-control" id="required_NRR" required />
            </div>
          </div>
          <div class="text-center mt-4">
            <button type="button" class="btn btn-primary px-4" onclick="calculateNRR()">Calculate</button>
          </div>
        </form>

        <div class="alert alert-danger mt-4 d-none" id="error"></div>

        <div class="card result-card d-none" id="results">
          <div class="card-body">
            <h5 class="card-title">ðŸ“Š Results</h5>
            <p id="current_nrr"></p>
            <p id="opponent_batting_first"></p>
            <p id="your_team_batting_first"></p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap Icons and JS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Tooltip init
    document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(el => new bootstrap.Tooltip(el));

    function oversToBalls(overs) {
      const parts = overs.split('.');
      const fullOvers = parseInt(parts[0]);
      const balls = parseInt(parts[1]) || 0;
      if (balls >= 6) return NaN;
      return (fullOvers * 6) + balls;
    }

    function ballsToOvers(balls) {
      const full = Math.floor(balls / 6);
      const rem = balls % 6;
      return `${full}.${rem}`;
    }

    function calculateNRR() {
      const errorEl = document.getElementById("error");
      const resultsEl = document.getElementById("results");
      errorEl.classList.add("d-none");
      resultsEl.classList.add("d-none");

      try {
        const team = document.getElementById("supporting_team").value.trim();
        const opponent = document.getElementById("against_team").value.trim();
        const runsScored = parseFloat(document.getElementById("runs_scored").value);
        const oversPlayed = oversToBalls(document.getElementById("overs_played").value);
        const runsAgainst = parseFloat(document.getElementById("runs_scored_against").value);
        const oversAgainst = oversToBalls(document.getElementById("overs_played_against").value);
        const matchOvers = oversToBalls(document.getElementById("overs").value);
        const finalRuns = parseFloat(document.getElementById("final_runs").value);
        const requiredNRR = parseFloat(document.getElementById("required_NRR").value);

        if ([oversPlayed, oversAgainst, matchOvers].some(isNaN)) {
          throw new Error("Invalid overs format. Use X.Y format (e.g., 19.4). Y must be â‰¤ 5.");
        }

        const currentNRR = ((runsScored / (oversPlayed / 6)) - (runsAgainst / (oversAgainst / 6))).toFixed(3);
        document.getElementById("current_nrr").innerHTML = `âœ… Current NRR of <strong>${team}</strong>: <strong>${currentNRR}</strong>`;

        const totalScored = runsScored + finalRuns + 1;
        const totalAgainst = runsAgainst + finalRuns;
        const totalOversAgainst = oversAgainst + matchOvers;
        const finalOversRequired = ((totalScored / ((totalAgainst / (totalOversAgainst / 6)) + requiredNRR)) - (oversPlayed / 6)) * 6;
        const chaseOvers = ballsToOvers(Math.ceil(finalOversRequired));

        document.getElementById("opponent_batting_first").innerHTML =
          `ðŸ“Œ If <strong>${opponent}</strong> bats first, <strong>${team}</strong> must chase <strong>${finalRuns}</strong> in <strong>${chaseOvers}</strong> overs or less.`;

        const newRuns = runsScored + finalRuns;
        const newOvers = oversPlayed + matchOvers;
        const newOversAgainst = oversAgainst + matchOvers;
        const maxRunsConceded = Math.floor(((new
